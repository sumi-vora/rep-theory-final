<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Test Weight Slice Viewer</title>
  <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
  <style>
    body {
      margin: 0;
      font-family: sans-serif;
      background-color: #f0f0f0;
    }
    #container {
      padding: 20px;
    }
    h1 {
      text-align: center;
    }
    #aframe-container {
      width: 100%;
      height: 500px;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <div id="container">
    <h1>Weight Slice Test</h1>
    <p>This A-Frame scene shows tableaux with weight vector <code>[1, 2, 1, 1, 0, 0, 1, 2, 1, 1, 1, 1]</code>.</p>
    <div id="aframe-container">
      <a-scene embedded>
        <a-entity id="point-cloud"></a-entity>
        <a-entity position="0 0 10">
          <a-camera wasd-controls-enabled="true" look-controls-enabled="true"></a-camera>
        </a-entity>
        <a-light type="ambient" color="#ccc"></a-light>
      </a-scene>
    </div>
  </div>

  <script type="module">
    function renderWeightSlice(data, targetWeight, containerId = 'point-cloud') {
    const cloud = document.getElementById(containerId);
    cloud.innerHTML = '';  // Clear existing points
  
    // Helper to compare two weight vectors
    function sameWeight(w1, w2) {
      return w1.every((val, i) => val === w2[i]);
    }
  
    const matching = data.filter(d => sameWeight(d.weight, targetWeight));
  
    matching.forEach(d => {
      const el = document.createElement('a-sphere');
      el.setAttribute('position', `${d.x} ${d.y} ${d.z}`);
      el.setAttribute('radius', '0.08');
      el.setAttribute('color', d.is_cluster ? '#F66' : '#69F');
      el.setAttribute('data-tableau', JSON.stringify(d.tableau));
      el.setAttribute('data-weight', JSON.stringify(d.weight));
      el.setAttribute('class', 'clickable');
      cloud.appendChild(el);
    });
  }
  
    // Simulated data (would normally be loaded from JSON)
    const mockData = [
      {
        tableau: [[1, 2, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11]],
        is_cluster: true,
        x: 1, y: 2, z: 3,
        weight: [1, 2, 1, 1, 0, 0, 1, 2, 1, 1, 1, 1]
      },
      {
        tableau: [[1, 2, 3, 3], [4, 5, 6, 7], [8, 9, 10, 12]],
        is_cluster: false,
        x: -2, y: 1, z: 1,
        weight: [1, 1, 2, 1, 0, 0, 1, 2, 1, 1, 1, 1]
      },
      {
        tableau: [[1, 2, 3, 4], [5, 6, 7, 8], [9, 10, 11, 12]],
        is_cluster: true,
        x: 0, y: 0, z: 0,
        weight: [1, 2, 1, 1, 0, 0, 1, 2, 1, 1, 1, 1]  // same as target
      }
    ];

    const targetWeight = [1, 2, 1, 1, 0, 0, 1, 2, 1, 1, 1, 1];
    renderWeightSlice(mockData, targetWeight);
  </script>
</body>
</html>
